box: wercker/nodejs
build:
  steps:
    - script:
        name: install global dependencies
        code: sudo npm install -g grunt-cli bower
    - script:
        name: install local dependencies
        code: npm install
    - script:
        name: install bower components
        code: bower install
    - script:
        name: run tests
        code: grunt test
    - script:
        name: build release
        code: grunt build:prod
deploy:
  steps:
    - s3sync:
        key-id: $KEY
        key-secret: $SECRET
        bucket-url: $BUCKET
        source-dir: $SOURCE
        opts: --acl-public
